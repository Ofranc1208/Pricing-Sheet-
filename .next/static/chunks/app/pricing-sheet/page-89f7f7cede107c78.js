(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{5490:function(e,t,a){Promise.resolve().then(a.bind(a,8013))},8013:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var n=a(7437),r=a(2265),l=a(7780);function s(e){let{onLoadMockData:t,onResetData:s,onRowsParsed:o}=e,[i,c]=(0,r.useState)("");async function d(e){var t;let n=e[0];if(!n)return;c("\uD83D\uDCC2 Processing ".concat(n.name,"..."));let r=null===(t=n.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();if("csv"===r){let e=await n.text(),t=(0,l.mf)(e);if(!t.success){c("❌ ".concat(t.errors.join("; ")));return}let a="✅ Loaded ".concat(t.data.length," rows");if(t.warnings.length>0){let e=t.warnings.slice(0,2).join("; ");a+=" ⚠️ ".concat(e),t.warnings.length>2&&(a+=" (+ ".concat(t.warnings.length-2," more)"))}c(a),null==o||o(t.data);return}if("xlsx"===r||"xls"===r){try{let e=await Promise.resolve().then(a.bind(a,7504)),t=await n.arrayBuffer(),r=e.read(t),s=r.SheetNames[0],i=r.Sheets[s],d=e.utils.sheet_to_csv(i);console.log("\uD83D\uDCCA Excel converted to CSV, first 500 chars:",d.substring(0,500));let m=(0,l.mf)(d);if(!m.success){c("❌ ".concat(m.errors.join("; ")));return}let u="✅ Loaded ".concat(m.data.length," rows");if(m.warnings.length>0){let e=m.warnings.slice(0,2).join("; ");u+=" ⚠️ ".concat(e),m.warnings.length>2&&(u+=" (+ ".concat(m.warnings.length-2," more)"))}c(u),null==o||o(m.data)}catch(e){c("❌ Error: ".concat(e))}return}c("❌ Unsupported file type")}return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow p-2",children:[(0,n.jsx)("h2",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Upload"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded p-2 text-center hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>{var e;return null===(e=document.getElementById("file-upload"))||void 0===e?void 0:e.click()},children:(0,n.jsxs)("div",{className:"text-gray-600",children:[(0,n.jsx)("p",{className:"font-medium text-xs",children:"CSV/Excel"}),(0,n.jsx)("p",{className:"text-[10px]",children:"Click or drag"})]})}),(0,n.jsx)("input",{id:"file-upload",type:"file",multiple:!1,accept:".csv,.xlsx,.xls",className:"hidden",onChange:e=>{let t=e.target.files;t&&t.length>0&&d(t)}}),(0,n.jsx)("div",{className:"bg-blue-50 rounded p-1.5",children:(0,n.jsx)("p",{className:"text-[10px] text-blue-800",children:"CSV, XLSX, XLS"})}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("button",{className:"w-full bg-green-600 hover:bg-green-700 text-white text-[10px] font-medium py-1 px-1 rounded transition-colors",children:"Process"}),(0,n.jsx)("button",{onClick:t,className:"w-full bg-blue-600 hover:bg-blue-700 text-white text-[10px] font-medium py-1 px-1 rounded transition-colors",children:"Load Mock"}),(0,n.jsx)("button",{onClick:s,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 text-[10px] font-medium py-1 px-1 rounded transition-colors",children:"Clear"})]})]}),i&&(0,n.jsx)("div",{className:"mt-2 p-1.5 rounded text-[9px] leading-tight ".concat(i.includes("✅")?"bg-green-50 text-green-800":i.includes("❌")?"bg-red-50 text-red-800":i.includes("\uD83D\uDCC2")?"bg-blue-50 text-blue-800":"bg-yellow-50 text-yellow-800"),children:i}),(0,n.jsx)("div",{className:"mt-2 bg-yellow-50 rounded p-1.5",children:(0,n.jsx)("p",{className:"text-yellow-800 text-[9px] leading-tight",children:"Auto-populates sheet with matching columns"})})]})}a(5215);let o={pricing:{label:"\uD83D\uDCCA Pricing",columns:[{key:"gender",label:"Gender",type:"select"},{key:"age",label:"Age",type:"number"},{key:"firstName",label:"First Name",type:"text"},{key:"lastName",label:"Last Name",type:"text"},{key:"insuranceCompany",label:"Insurance Co.",type:"text"},{key:"typeOfPayment",label:"Payment Type",type:"select"},{key:"paymentFrequency",label:"Frequency",type:"select"},{key:"paymentStartDate",label:"Start Date",type:"date"},{key:"paymentEndDate",label:"End Date",type:"date"},{key:"paymentAmount",label:"Amount",type:"number"},{key:"annualIncrease",label:"Ann Inc",type:"number"},{key:"paymentCount",label:"# Payments",type:"number"},{key:"lowRange",label:"Low Range",type:"number"},{key:"highRange",label:"High Range",type:"number"},{key:"deathBenefits",label:"Death Ben.",type:"number"}]},contact:{label:"\uD83D\uDCDE Contact",columns:[{key:"crmId",label:"CRM ID",type:"text"},{key:"phone1",label:"Phone 1",type:"text"},{key:"phone2",label:"Phone 2",type:"text"},{key:"phone3",label:"Phone 3",type:"text"}]},address:{label:"\uD83D\uDCCD Address",columns:[{key:"fullAddress",label:"Full Address",type:"text"},{key:"streetAddress1",label:"Street 1",type:"text"},{key:"streetAddress2",label:"Street 2",type:"text"},{key:"city",label:"City",type:"text"},{key:"state",label:"State",type:"text"},{key:"zipCode",label:"ZIP Code",type:"text"}]}};o.pricing.columns;let i=e=>{let{rowCount:t}=e;return t<=2e3?null:(0,n.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,n.jsxs)("div",{className:"ml-3",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Large Dataset Detected"}),(0,n.jsxs)("div",{className:"mt-2 text-sm text-yellow-700",children:[(0,n.jsxs)("p",{children:["Your dataset contains ",t.toLocaleString()," rows. For optimal performance, consider:"]}),(0,n.jsxs)("ul",{className:"mt-1 list-disc list-inside",children:[(0,n.jsx)("li",{children:"Processing in smaller batches (e.g., 500-1000 rows)"}),(0,n.jsx)("li",{children:"Using pagination to navigate through results"}),(0,n.jsx)("li",{children:"Filtering data before upload if possible"})]})]})]})]})})};function c(e){var t;let{rows:a,updateRow:l,onExportOffersOnly:s}=e,[c,d]=(0,r.useState)("pricing"),[m,u]=(0,r.useState)(1),[p]=(0,r.useState)(50),y=(null===(t=o[c])||void 0===t?void 0:t.columns)||o.pricing.columns,g=Math.ceil(a.length/p),h=(m-1)*p,x=h+p,f=a.slice(h,x),b=a.reduce((e,t)=>(t.highRange&&""!==t.highRange&&"No Offer"!==t.highRange?e.offers++:"No Offer"===t.highRange&&e.noOffers++,e),{offers:0,noOffers:0}),N=e=>"No Offer"===e.highRange||"No Offer"===e.lowRange,v=e=>{if(!e||"0"===e||""===e)return"";let t=parseFloat(e.replace(/[,$]/g,""));return isNaN(t)?e:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},j=(e,t)=>{let a=e[t.key]||"";if("select"===t.type&&"gender"===t.key)return(0,n.jsxs)("select",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),value:a,onChange:a=>l(e.id,t.key,a.target.value),className:"pricing-field-input",children:[(0,n.jsx)("option",{value:"",children:"Select"}),(0,n.jsx)("option",{value:"male",children:"Male"}),(0,n.jsx)("option",{value:"female",children:"Female"})]});if("select"===t.type&&"typeOfPayment"===t.key)return(0,n.jsxs)("select",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),value:a,onChange:a=>l(e.id,t.key,a.target.value),className:"pricing-field-input",children:[(0,n.jsx)("option",{value:"",children:"Select"}),(0,n.jsx)("option",{value:"LCP",children:"LCP"}),(0,n.jsx)("option",{value:"GP",children:"GP"})]});if("select"===t.type&&"paymentFrequency"===t.key)return(0,n.jsxs)("select",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),value:a,onChange:a=>l(e.id,t.key,a.target.value),className:"pricing-field-input",children:[(0,n.jsx)("option",{value:"",children:"Select"}),(0,n.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,n.jsx)("option",{value:"Quarterly",children:"Quarterly"}),(0,n.jsx)("option",{value:"Semiannually",children:"Semi-Annually"}),(0,n.jsx)("option",{value:"Annually",children:"Annually"}),(0,n.jsx)("option",{value:"Lump Sum",children:"Lump Sum"})]});if("date"===t.type)return(0,n.jsx)("input",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),type:"date",value:a,onChange:a=>l(e.id,t.key,a.target.value),className:"pricing-field-input pricing-date-input",placeholder:""});if("paymentCount"===t.key)return(0,n.jsx)("input",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),type:"text",value:a||"",readOnly:!0,className:"pricing-field-input pricing-currency-input",placeholder:"Auto",title:"Number of Payments - Automatically calculated based on frequency and dates"});if(["lowRange","highRange","deathBenefits"].includes(t.key)){let r=v(a||"");return(0,n.jsx)("input",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),type:"text",value:r||"",onChange:a=>{let n=a.target.value.replace(/[,$]/g,"");l(e.id,t.key,n)},className:"pricing-field-input pricing-currency-input",placeholder:"Output value",title:"Calculated ".concat(t.label," - This field will be populated by the calculator")})}if("paymentAmount"===t.key){let r=v(a||"");return(0,n.jsx)("input",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),type:"text",value:r||"",onChange:a=>{let n=a.target.value.replace(/[,$]/g,"");l(e.id,t.key,n)},className:"pricing-field-input",placeholder:"$0.00",title:"Payment Amount - Enter the payment amount"})}if("annualIncrease"===t.key){let r=parseFloat(a||"0")||0;return(0,n.jsx)("input",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),type:"number",value:r,onChange:a=>{let n=parseFloat(a.target.value)||0;l(e.id,t.key,n.toString())},className:"pricing-field-input",placeholder:"0",title:"".concat(t.label," - Always 0% (percentage)"),min:"0",max:"0",step:"1"})}return(0,n.jsx)("input",{id:"".concat(t.key,"-").concat(e.id),name:"".concat(t.key,"-").concat(e.id),type:t.type,value:a||"",onChange:a=>l(e.id,t.key,a.target.value),className:"pricing-field-input",placeholder:"Enter ".concat(t.label.toLowerCase())})};return(0,n.jsxs)("div",{className:"pricing-fields-container",children:[(0,n.jsx)(i,{rowCount:a.length}),(b.offers>0||b.noOffers>0)&&(0,n.jsxs)("div",{className:"mb-3 flex items-center justify-between bg-white p-3 rounded-lg shadow-sm border border-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:"Lead Stats:"})}),(0,n.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-50 border border-green-200 rounded",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Offers:"}),(0,n.jsx)("span",{className:"text-sm font-bold text-green-900",children:b.offers})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-red-50 border border-red-200 rounded",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-red-800",children:"No Offers:"}),(0,n.jsx)("span",{className:"text-sm font-bold text-red-900",children:b.noOffers})]})]}),b.offers>0&&s&&(0,n.jsxs)("button",{onClick:s,className:"bg-green-600 hover:bg-green-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors shadow-sm flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Offers Only"]})]}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-3",children:(0,n.jsx)("div",{className:"border-b border-gray-200",children:(0,n.jsx)("nav",{className:"-mb-px flex space-x-8 px-4",children:Object.entries(o).map(e=>{let[t,a]=e;return(0,n.jsx)("button",{onClick:()=>d(t),className:"py-3 px-1 border-b-2 font-medium text-sm transition-colors ".concat(c===t?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.label},t)})})})}),(0,n.jsx)("div",{className:"pricing-fields-wrapper",children:(0,n.jsx)("div",{className:"pricing-fields-scroll-area",children:(0,n.jsxs)("table",{className:"pricing-fields-table",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:y.map(e=>{let t=["paymentCount","lowRange","highRange","deathBenefits"].includes(e.key);return(0,n.jsx)("th",{className:t?"pricing-output-header":"pricing-input-header",children:(0,n.jsx)("div",{className:"pricing-header-content",title:e.label,children:e.label})},e.key)})})}),(0,n.jsx)("tbody",{children:f.map((e,t)=>(0,n.jsx)("tr",{className:"pricing-table-row ".concat(t%2==0?"pricing-row-even":"pricing-row-odd"," ").concat(N(e)?"pricing-row-no-offer":""),children:y.map(t=>(0,n.jsx)("td",{className:"pricing-table-cell",children:(0,n.jsx)("div",{className:"pricing-cell-content",children:j(e,t)})},t.key))},e.id))})]})})}),a.length>p&&(0,n.jsxs)("div",{className:"mt-4 flex items-center justify-between bg-white px-4 py-3 border-t border-gray-200",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",h+1," to ",Math.min(x,a.length)," of ",a.length," entries"]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>u(Math.max(1,m-1)),disabled:1===m,className:"px-3 py-1 border border-gray-300 rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,n.jsxs)("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",m," of ",g]}),(0,n.jsx)("button",{onClick:()=>u(Math.min(g,m+1)),disabled:m===g,className:"px-3 py-1 border border-gray-300 rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]})}let d=e=>{let[t,a,n]=e.split("/");return"".concat(n,"-").concat(t.padStart(2,"0"),"-").concat(a.padStart(2,"0"))},m=e=>e.replace(/[,$]/g,""),u=Array.from({length:5},(e,t)=>({id:"row-".concat(t+1),gender:"",age:"",firstName:"",lastName:"",insuranceCompany:"",typeOfPayment:"",paymentFrequency:"",paymentStartDate:"",paymentEndDate:"",paymentAmount:"",annualIncrease:"0",paymentCount:"",lowRange:"",highRange:"",deathBenefits:"",crmId:"",phone1:"",phone2:"",phone3:"",fullAddress:"",streetAddress1:"",streetAddress2:"",city:"",state:"",zipCode:""})),p=()=>{let e=[];return[{gender:"male",age:"40",firstName:"Saleh",lastName:"Abdullah",insuranceCompany:"American Home Life Insurance Company",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"5/1/2026",endDate:"5/1/2054",amount:"4090.86",annualIncrease:"0"},{gender:"male",age:"44",firstName:"Martha",lastName:"Abreu",insuranceCompany:"New York Life",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"1/2/2026",endDate:"1/2/2054",amount:"4062.82",annualIncrease:"0"},{gender:"male",age:"43",firstName:"Ramon",lastName:"Acevedo",insuranceCompany:"GABC",paymentType:"GP",paymentFrequency:"Quarterly",startDate:"9/15/2026",endDate:"9/15/2054",amount:"1800.00",annualIncrease:"2"},{gender:"male",age:"53",firstName:"Robert",lastName:"Acken",insuranceCompany:"John Hancock",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"1/1/2026",endDate:"1/1/2043",amount:"4062.82",annualIncrease:"0"},{gender:"female",age:"58",firstName:"Brian",lastName:"Ackley",insuranceCompany:"Symetra",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"1/1/2026",endDate:"1/1/2040",amount:"4644.68",annualIncrease:"0"},{gender:"female",age:"36",firstName:"Bonnie",lastName:"Acosta",insuranceCompany:"Transamerica",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"9/9/2044",endDate:"9/9/2054",amount:"8470.43",annualIncrease:"3"},{gender:"male",age:"57",firstName:"John",lastName:"Adams",insuranceCompany:"Nationwide",paymentType:"GP",paymentFrequency:"Annually",startDate:"10/1/2029",endDate:"10/1/2040",amount:"4500.00",annualIncrease:"1"},{gender:"male",age:"44",firstName:"Michael",lastName:"Adams",insuranceCompany:"Commonwealth",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"5/7/2040",endDate:"5/7/2054",amount:"1673.80",annualIncrease:"0"},{gender:"female",age:"55",firstName:"Sherrie",lastName:"Adams",insuranceCompany:"Transamerica",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"5/27/2026",endDate:"5/27/2049",amount:"2994.99",annualIncrease:"0"},{gender:"male",age:"52",firstName:"Jon",lastName:"Addison",insuranceCompany:"Symetra",paymentType:"LCP",paymentFrequency:"Monthly",startDate:"1/1/2026",endDate:"1/1/2049",amount:"1813.94",annualIncrease:"0"}].forEach((t,a)=>{e.push({id:"row-".concat(a+1),gender:t.gender,age:t.age,firstName:t.firstName,lastName:t.lastName,insuranceCompany:t.insuranceCompany,typeOfPayment:t.paymentType,paymentFrequency:t.paymentFrequency,paymentStartDate:d(t.startDate),paymentEndDate:d(t.endDate),paymentAmount:m(t.amount),annualIncrease:t.annualIncrease,paymentCount:"",lowRange:"",highRange:"",deathBenefits:"",crmId:"",phone1:"",phone2:"",phone3:"",fullAddress:"",streetAddress1:"",streetAddress2:"",city:"",state:"",zipCode:""})}),e},y="pricing-sheet-data";function g(e){try{let t={version:"1.0",timestamp:Date.now(),rows:e};localStorage.setItem(y,JSON.stringify(t)),console.log("\uD83D\uDCBE Saved ".concat(e.length," rows to localStorage"))}catch(e){console.error("❌ Failed to save to localStorage:",e)}}function h(){try{localStorage.removeItem(y),console.log("\uD83D\uDCBE Cleared pricing data from localStorage")}catch(e){console.error("❌ Failed to clear localStorage:",e)}}function x(){let[e,t]=(0,r.useState)(u),[a,o]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=function(){try{let e=localStorage.getItem(y);if(!e)return console.log("\uD83D\uDCBE No saved data found in localStorage"),null;let t=JSON.parse(e);if("1.0"!==t.version)return console.warn("\uD83D\uDCBE Version mismatch: ".concat(t.version," vs ").concat("1.0",", clearing old data")),h(),null;let a=Date.now()-t.timestamp;return console.log("\uD83D\uDCBE Loaded ".concat(t.rows.length," rows from localStorage (").concat((a/36e5).toFixed(1)," hours old)")),t.rows}catch(e){return console.error("❌ Failed to load from localStorage:",e),h(),null}}();if(e&&e.length>0){t(e);let a=function(){try{let e=localStorage.getItem(y);if(!e)return null;let t=JSON.parse(e),a=Date.now()-t.timestamp,n=new Blob([e]).size;return{size:n>1024?"".concat((n/1024).toFixed(1),"KB"):"".concat(n,"B"),age:"".concat((a/36e5).toFixed(1),"h old")}}catch(e){return null}}();a&&o("\uD83D\uDCBE Loaded ".concat(e.length," rows (").concat(a.age,")"))}else o("")},[]);let i=e=>{"function"==typeof e?t(t=>{let a=e(t);return g(a),a}):(t(e),g(e))};return(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 p-2 md:p-3",children:(0,n.jsxs)("div",{className:"max-w-full mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-3 md:mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Pricing Sheet"}),a&&(0,n.jsx)("div",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:a})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{onClick:()=>{i(e=>e.map(e=>{if(e.gender&&e.age&&e.typeOfPayment&&e.paymentStartDate&&e.paymentEndDate&&e.paymentAmount){let t=function(e){if(!(0,l.v2)(e))return{paymentCount:"",lowRange:"",highRange:"",deathBenefits:""};let t=e.typeOfPayment,a=parseInt(e.age),n=e.gender,r=parseFloat(e.paymentAmount),s=e.paymentStartDate,o=e.paymentEndDate;try{let i=(0,l.g9)(t),c="GP"===t?0:(0,l.pH)(a,n),d="LCP"===t?(0,l.dE)(a,n):[],{minOffer:m,maxOffer:u}=(0,l._H)(r,s,o,i+c,t,d,e.paymentFrequency,parseFloat(e.annualIncrease)||0),p="GP"===t?0:(0,l.m6)(r,s,o,e.paymentFrequency,parseFloat(e.annualIncrease)||0),y=(0,l.$z)(s,o,e.paymentFrequency);if(u<15e3)return{paymentCount:y.toString(),lowRange:"No Offer",highRange:"No Offer",deathBenefits:p.toFixed(2)};return{paymentCount:y.toString(),lowRange:m.toFixed(2),highRange:u.toFixed(2),deathBenefits:p.toFixed(2)}}catch(e){return console.error("Error calculating pricing outputs:",e),{paymentCount:"",lowRange:"",highRange:"",deathBenefits:""}}}(e);return{...e,paymentCount:t.paymentCount,lowRange:t.lowRange,highRange:t.highRange,deathBenefits:t.deathBenefits}}return e}))},className:"bg-green-600 hover:bg-green-700 text-white text-sm font-medium py-2 px-6 rounded-lg transition-colors shadow-sm",children:"▶ Start Calculations"}),(0,n.jsx)("button",{onClick:()=>{if(0===(0,l.p)(e).validRows){alert("No valid data to export. Please ensure you have data with names and amounts.");return}(0,l.pq)(e,{includeCalculations:!0,filename:"pricing-sheet-all-data"})},className:"bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors shadow-sm",children:"\uD83D\uDCE5 Export Excel"}),(0,n.jsx)("a",{href:"/pricing-sheet/debug",className:"bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors shadow-sm",children:"\uD83D\uDD0D Debug NPV"}),(0,n.jsx)("button",{onClick:()=>{h(),window.location.reload()},className:"bg-red-600 hover:bg-red-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors shadow-sm",title:"Clear all data and refresh page",children:"\uD83D\uDD04 Reset"})]})]}),(0,n.jsx)("div",{className:"mb-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Existing Rules"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Data will be automatically populated when files are uploaded"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("div",{className:"bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200",children:[(0,n.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:e.filter(e=>e.firstName&&e.lastName).length}),(0,n.jsx)("span",{className:"text-sm text-gray-600 ml-2",children:"Active Rules"})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Last Updated"}),(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Today, 2:30 PM"})]})]})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-3",children:[(0,n.jsx)("div",{className:"xl:col-span-2 order-2 xl:order-1",children:(0,n.jsx)(s,{onLoadMockData:()=>{i(p())},onResetData:()=>{i(u)},onRowsParsed:t=>{let a=t.map((e,t)=>({id:"upload-".concat(Date.now(),"-").concat(t),gender:e.gender||"",age:e.age||"",firstName:e.firstName||"",lastName:e.lastName||"",insuranceCompany:e.insuranceCompany||"",typeOfPayment:e.typeOfPayment||"",paymentFrequency:e.paymentFrequency||"",paymentStartDate:e.paymentStartDate||"",paymentEndDate:e.paymentEndDate||"",paymentAmount:e.paymentAmount||"",annualIncrease:e.annualIncrease||"0",paymentCount:"",lowRange:"",highRange:"",deathBenefits:"",crmId:e.crmId||"",phone1:e.phone1||"",phone2:e.phone2||"",phone3:e.phone3||"",fullAddress:e.fullAddress||"",streetAddress1:e.streetAddress1||"",streetAddress2:e.streetAddress2||"",city:e.city||"",state:e.state||"",zipCode:e.zipCode||""}));i(a.length>0?a:e)}})}),(0,n.jsx)("div",{className:"xl:col-span-10 order-1 xl:order-2",children:(0,n.jsx)(c,{rows:e,updateRow:(e,t,a)=>{i(n=>n.map(n=>n.id===e?{...n,[t]:a}:n))},onExportOffersOnly:()=>{let t=e.filter(e=>e.highRange&&""!==e.highRange&&"No Offer"!==e.highRange);if(0===t.length){alert("No offers to export. Please run calculations first and ensure some deals have valid offers.");return}(0,l.pq)(t,{includeCalculations:!0,filename:"pricing-sheet-offers-only"})}})})]})]})})}},5215:function(){}},function(e){e.O(0,[425,279,971,938,744],function(){return e(e.s=5490)}),_N_E=e.O()}]);
exports.id=695,exports.ids=[695],exports.modules={346:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2583,23)),Promise.resolve().then(n.t.bind(n,6840,23)),Promise.resolve().then(n.t.bind(n,8771,23)),Promise.resolve().then(n.t.bind(n,3225,23)),Promise.resolve().then(n.t.bind(n,9295,23)),Promise.resolve().then(n.t.bind(n,3982,23))},915:()=>{},9182:(e,t,n)=>{"use strict";n.d(t,{Bq:()=>l,Em:()=>a,T2:()=>o,jm:()=>u,pt:()=>i,r:()=>s,wV:()=>r,yZ:()=>m});let a=.085,r=.085,s=.085,l=.085,m={min:.03,max:.02},u={min:3e4,max:2e4},o=.055,i={"gender-male":0,"gender-female":-.01,"age-18-25":0,"age-26-35":.01,"age-36-45":.02,"age-46-50":.03,"age-51-56":.045,"age-57-65":.06}},7177:(e,t,n)=>{"use strict";n.d(t,{B8:()=>l,Eh:()=>u,gN:()=>s,gr:()=>m});var a=n(9182);let r={BASE_DISCOUNT_RATE:a.Em,BASE_DISCOUNT_RATE_LCP:a.wV,BASE_DISCOUNT_RATE_LUMP_SUM_GUARANTEED:a.r,BASE_DISCOUNT_RATE_LUMP_SUM_LCP:a.Bq,RATE_SPREADS:a.yZ,AMOUNT_ADJUSTMENTS:a.jm,FAMILY_PROTECTION_DISCOUNT_RATE:a.T2,PAYMENT_FREQUENCY:"Monthly",PAYMENT_INCREASE_RATE:0,DEFAULT_PAYMENT_FREQUENCY:"Monthly",DEFAULT_ANNUAL_INCREASE:0,adjustmentMap:{...a.pt}},s={...r};function l(){return s}function m(e){s={...s,...e},e.adjustmentMap&&(s.adjustmentMap={...s.adjustmentMap,...e.adjustmentMap})}function u(){s={...r}}},79:(e,t,n)=>{"use strict";function a(e){return!!(e.gender&&e.age&&e.typeOfPayment&&e.paymentStartDate&&e.paymentEndDate&&e.paymentAmount&&parseFloat(e.paymentAmount)>0)}n.d(t,{m6:()=>y,CY:()=>d,_H:()=>i,$z:()=>p,pq:()=>_,P0:()=>m,g9:()=>c,p:()=>P,dE:()=>s,pH:()=>l,v2:()=>a,mf:()=>A});var r=n(7177);function s(e,t){let n=[];return"male"===t?n.push("gender-male"):"female"===t&&n.push("gender-female"),e>=18&&e<=25?n.push("age-18-25"):e>=26&&e<=35?n.push("age-26-35"):e>=36&&e<=45?n.push("age-36-45"):e>=46&&e<=50?n.push("age-46-50"):e>=51&&e<=56?n.push("age-51-56"):e>=57&&e<=65&&n.push("age-57-65"),n}function l(e,t){let n=0;return"male"===t?n+=r.gN.adjustmentMap["gender-male"]||0:"female"===t&&(n+=r.gN.adjustmentMap["gender-female"]||0),e>=18&&e<=25?n+=r.gN.adjustmentMap["age-18-25"]||0:e>=26&&e<=35?n+=r.gN.adjustmentMap["age-26-35"]||0:e>=36&&e<=45?n+=r.gN.adjustmentMap["age-36-45"]||0:e>=46&&e<=50?n+=r.gN.adjustmentMap["age-46-50"]||0:e>=51&&e<=56?n+=r.gN.adjustmentMap["age-51-56"]||0:e>=57&&e<=65&&(n+=r.gN.adjustmentMap["age-57-65"]||0),n}function m(e){return e>=18&&e<=25?"18-25":e>=26&&e<=35?"26-35":e>=36&&e<=45?"36-45":e>=46&&e<=50?"46-50":e>=51&&e<=56?"51-56":e>=57&&e<=65?"57-65":"unknown"}var u=n(9182);function o({amount:e,startDate:t,endDate:n,annualRate:a,paymentMode:r,increaseRate:s=0}){let l=new Date(t),m=new Date(n),u=new Date;u.setHours(0,0,0,0);let o={Monthly:12,Quarterly:4,Semiannually:2,Annually:1,"Lump Sum":1}[r]||12,i=12/o,d=0,c=e,p=0;for(let e=new Date(l);e<=m&&("Lump Sum"!==r||!(p>0));e=function(e,t){let n=new Date(e),a=n.getDate();return n.setMonth(n.getMonth()+t),n.getDate()<a&&n.setDate(0),n}(e,i),p++){let t=(e.getFullYear()-u.getFullYear())*12+(e.getMonth()-u.getMonth());t>=0&&(d+=c/Math.pow(1+a/12,t)),(p+1)%o==0&&(c*=1+s/100)}return{npv:parseFloat(d.toFixed(2)),payments:p}}function i(e,t,n,a,s,l,m,i){return function({amount:e,startDate:t,endDate:n,baseRate:a=u.Em,paymentMode:r,increaseRate:s=0,minRateSpread:l=u.yZ.min,maxRateSpread:m=u.yZ.max,minAdjustment:i=0,maxAdjustment:d=0,isLCP:c=!1,lcpKeys:p=[]}){let y=c?p.reduce((e,t)=>e+(u.pt[t]||0),0):0,g=o({amount:e,startDate:t,endDate:n,annualRate:a+y+l,paymentMode:r,increaseRate:s}),h=o({amount:e,startDate:t,endDate:n,annualRate:a+y+m,paymentMode:r,increaseRate:s}),f=e=>100*Math.ceil((e-.001)/100);return{minOffer:Math.max(0,f(g.npv-i)),maxOffer:Math.max(0,f(h.npv-d))}}({amount:e,startDate:t,endDate:n,baseRate:a,paymentMode:m||r.gN.PAYMENT_FREQUENCY,increaseRate:void 0!==i?i:r.gN.PAYMENT_INCREASE_RATE,minRateSpread:r.gN.RATE_SPREADS.min,maxRateSpread:r.gN.RATE_SPREADS.max,minAdjustment:r.gN.AMOUNT_ADJUSTMENTS.min,maxAdjustment:r.gN.AMOUNT_ADJUSTMENTS.max,isLCP:!1,lcpKeys:[]})}function d(e,t,n,a,s){let l=a||r.gN.PAYMENT_FREQUENCY,m=void 0!==s?s:r.gN.PAYMENT_INCREASE_RATE;return function({amount:e,startDate:t,endDate:n,discountRate:a,paymentMode:r,increaseRate:s=0}){return o({amount:e,startDate:t,endDate:n,annualRate:a/100,paymentMode:r,increaseRate:s})}({amount:e,startDate:t,endDate:n,discountRate:r.gN.FAMILY_PROTECTION_DISCOUNT_RATE,paymentMode:l,increaseRate:m}).npv}function c(e){return"LCP"===e?r.gN.BASE_DISCOUNT_RATE_LCP:r.gN.BASE_DISCOUNT_RATE}function p(e,t,n){if(!e||!t||!n)return 0;let a=new Date(e),r=new Date(t),s=12/(({Monthly:12,Quarterly:4,Semiannually:2,"Semi-Annually":2,Annually:1,"Lump Sum":1})[n]||12);if("Lump Sum"===n)return 1;let l=0;for(let e=new Date(a);e<=r;e=function(e,t){let n=new Date(e),a=n.getDate();return n.setMonth(n.getMonth()+t),n.getDate()<a&&n.setDate(0),n}(e,s),l++);return l}function y(e,t,n,a,s){let l=a||r.gN.PAYMENT_FREQUENCY,m=void 0!==s?s:r.gN.PAYMENT_INCREASE_RATE,u=r.gN.FAMILY_PROTECTION_DISCOUNT_RATE,o=new Date(t),i=new Date(n),d={Monthly:12,Quarterly:4,Semiannually:2,"Semi-Annually":2,Annually:1,"Lump Sum":1}[l]||12,c=12/d,p=[],y=e,g=0;for(let e=new Date(o);e<=i&&("Lump Sum"!==l||!(g>0));e=function(e,t){let n=new Date(e),a=n.getDate();return n.setMonth(n.getMonth()+t),n.getDate()<a&&n.setDate(0),n}(e,c),g++)p.push({date:new Date(e),amt:y}),(g+1)%d==0&&(y*=1+m/100);let h=0;for(let e=0;e<p.length;e++){let t=0,n=p[e].date;for(let a=e;a<p.length;a++){let e=p[a],r=Math.pow(1+u/12,(e.date.getFullYear()-n.getFullYear())*12+(e.date.getMonth()-n.getMonth()));t+=e.amt/r}t>h&&(h=t)}return parseFloat((1e4*Math.ceil((h+2e4-.001)/1e4)).toFixed(2))}let g={gender:["gender","sex","gender/sex","male/female","m/f","Gender","Sex","Gender/Sex","Male/Female","M/F"],age:["age","age at issue","current age","age (years)","Age","Age at Issue","Current Age","Age (Years)"],firstName:["first name","firstname","first","fname","name first","given name","First Name","FirstName","First","FName","Name First","Given Name"],lastName:["last name","lastname","last","lname","surname","name last","family name","Last Name","LastName","Last","LName","Surname","Name Last","Family Name"],insuranceCompany:["insurance company","ins company","ins co","carrier","insurance carrier","company","Insurance Company","insurance_company","ins_carrier","carrier_name","structured settlement carrier","annuity carrier"],typeOfPayment:["payment type","payment","pymt type","type","structure type","lcp/gp","Payment Type","payment_type","structure_type","payout_type","annuity_type","settlement_type"],paymentFrequency:["payment frequency","frequency","freq","how often","payment freq","Payment Frequency","payment_frequency","frequency_type","freq_type"],paymentStartDate:["start date","start","begin date","payment start","commencement date","Payment Start Date","payment start date","start_date","startdate","begin_date","begindate","commencement_date","commencementdate","payment start date","paymentstartdate"],paymentEndDate:["end date","end","maturity date","payment end","termination date","Payment End Date","payment end date","end_date","enddate","maturity_date","maturitydate","termination_date","terminationdate","payment end date","paymentenddate"],paymentAmount:["amount","payment amount","monthly amount","payment","payout amount","Payment Amount","payment_amount","amount_paid","monthly_payment","payout","settlement amount","structured settlement amount","payment amount","paymentamount"],annualIncrease:["annual increase","increase","increase %","increase rate","ann inc","col %","Annual Increase","Increase","Increase %","Increase Rate","Ann Inc","Col %","annual_increase","increase_rate","annual_inc","col_percent"],crmId:["crm id","crm","lead id","record id","crm_id","Lead ID","CRM ID"],phone1:["phone 1","phone1","primary phone","mobile","cell","Phone 1","Primary Phone"],phone2:["phone 2","phone2","secondary phone","alt phone","Phone 2","Secondary Phone"],phone3:["phone 3","phone3","other phone","alternate phone","Phone 3"],fullAddress:["address","full address","mailing address","Address","Full Address"],streetAddress1:["street 1","street1","address 1","address line 1","Street 1","Address 1","Address Line 1"],streetAddress2:["street 2","street2","address 2","address line 2","Street 2","Address 2","Address Line 2"],city:["city","City"],state:["state","st","State"],zipCode:["zip","zip code","zipcode","postal code","Zip","ZIP Code","Postal Code"]};function h(e){return e.toLowerCase().trim().replace(/[^a-z0-9]/g,"")}function f(e){let t=[],n="",a=!1;for(let r=0;r<e.length;r++){let s=e[r],l=e[r+1];'"'===s?a&&'"'===l?(n+='"',r++):a=!a:","!==s||a?n+=s:(t.push(n.trim()),n="")}return t.push(n.trim()),t}function A(e){let t={success:!1,data:[],errors:[],warnings:[]};try{let n=e.split("\n").filter(e=>e.trim());if(n.length<2)return t.errors.push("CSV must have at least header row and one data row"),t;n.length>1e4&&t.warnings.push("Large file detected. Processing may take longer.");let a=f(n[0]),r={};a.forEach((e,t)=>{let n=function(e,t){let n=h(e);for(let[e,a]of Object.entries(t))for(let t of a)if(h(t)===n)return e;return null}(e,g);n&&(r[t]=n)});let s=["gender","age","firstName","lastName","paymentAmount","paymentStartDate","paymentEndDate"].filter(e=>!Object.values(r).includes(e));if(s.length>0)return t.errors.push(`Missing required fields: ${s.join(", ")}. Found headers: ${a.join(", ")}`),t;let l=Object.values(r).includes("typeOfPayment"),m=Object.values(r).includes("paymentFrequency");l||t.warnings.push("Payment Type not found - defaulting to LCP for all rows"),m||t.warnings.push("Payment Frequency not found - defaulting to Monthly for all rows");let u=n.length-1;for(let e=1;e<n.length;e++){u>5e3&&e%1e3==0&&console.log(`Processing row ${e} of ${u}`);let s=f(n[e]);if(s.length<a.length){t.warnings.push(`Row ${e+1}: Too few columns (expected ${a.length}, got ${s.length})`);continue}s.length>a.length&&(s.length=a.length);let l={gender:"",age:"",firstName:"",lastName:"",insuranceCompany:"",typeOfPayment:"LCP",paymentFrequency:"Monthly",paymentStartDate:"",paymentEndDate:"",paymentAmount:"",annualIncrease:"0",crmId:"",phone1:"",phone2:"",phone3:"",fullAddress:"",streetAddress1:"",streetAddress2:"",city:"",state:"",zipCode:""};Object.entries(r).forEach(([e,t])=>{let n=parseInt(e);if(n<s.length){var a,r;let e=s[n];switch(t){case"gender":e=function(e){if(!e)return"";let t=h(e);return["m","male","man"].includes(t)?"male":["f","female","woman"].includes(t)?"female":e}(e);break;case"paymentFrequency":e=(a=e)?({monthly:"Monthly",quarterly:"Quarterly",quarter:"Quarterly",semi:"Semiannually",semiannually:"Semiannually","semi-annually":"Semiannually",annual:"Annually",annually:"Annually",yearly:"Annually",lump:"Lump Sum",lumpsum:"Lump Sum","one-time":"Lump Sum"})[h(a)]||a:"";break;case"typeOfPayment":e=function(e){if(!e)return"";let t=h(e);return["lcp","life","lifecontingent"].includes(t)?"LCP":["gp","guaranteed"].includes(t)?"GP":e}(e);break;case"annualIncrease":e=function(e){if(!e||""===e.trim())return"0";let t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?"0":t>1&&t<=100?t.toString():t>0&&t<=1?(100*t).toString():"0"}(e);break;case"paymentAmount":e=(r=e)?r.replace(/[$,]/g,"").trim():"";break;case"paymentStartDate":case"paymentEndDate":e=function(e){if(!e)return"";for(let t of[/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})$/,/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/,/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})$/]){let n=e.trim().match(t);if(n){let e,a,r;if(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})$/===t?(a=parseInt(n[1]),r=parseInt(n[2]),e=2e3+parseInt(n[3])):/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/===t?(a=parseInt(n[1]),r=parseInt(n[2]),e=parseInt(n[3])):(e=parseInt(n[1]),a=parseInt(n[2]),r=parseInt(n[3])),a>=1&&a<=12&&r>=1&&r<=31&&e>=1900){let t=a.toString().padStart(2,"0"),n=r.toString().padStart(2,"0");return`${e}-${t}-${n}`}}}let t=new Date(e);return isNaN(t.getTime())?e:t.toISOString().split("T")[0]}(e)}l[t]=e}}),t.data.push(l)}t.success=!0;let o=t.warnings.filter(e=>!e.includes("Column count mismatch")&&!e.includes("Too few columns"));return t.warnings=o,t.data.length>0&&console.log(`✅ Successfully parsed ${t.data.length} rows from CSV`),t}catch(e){return t.errors.push(`Parse error: ${e}`),t}}var N=n(8292);let S=["Gender","Age","First Name","Last Name","Insurance Company","Payment Type","Payment Frequency","Start Date","End Date","Amount","Annual Increase","Number of Payments","Low Range","High Range","Death Benefits","CRM ID","Phone 1","Phone 2","Phone 3","Full Address","Street Address 1","Street Address 2","City","State","ZIP Code"],E={Gender:"gender",Age:"age","First Name":"firstName","Last Name":"lastName","Insurance Company":"insuranceCompany","Payment Type":"typeOfPayment","Payment Frequency":"paymentFrequency","Start Date":"paymentStartDate","End Date":"paymentEndDate",Amount:"paymentAmount","Annual Increase":"annualIncrease","Number of Payments":"paymentCount","Low Range":"lowRange","High Range":"highRange","Death Benefits":"deathBenefits","CRM ID":"crmId","Phone 1":"phone1","Phone 2":"phone2","Phone 3":"phone3","Full Address":"fullAddress","Street Address 1":"streetAddress1","Street Address 2":"streetAddress2",City:"city",State:"state","ZIP Code":"zipCode"};function _(e,t={}){let{includeCalculations:n=!1,filename:a="pricing-sheet-export"}=t;try{let t=e.filter(e=>e.firstName&&e.lastName&&e.paymentAmount);if(0===t.length){alert("No valid data to export. Please ensure you have data with names and amounts.");return}let n=[];n.push(S),t.forEach(e=>{let t=[];S.forEach(n=>{let a=e[E[n]]||"";if("Gender"===n)a="male"===a?"Male":"female"===a?"Female":a;else if("Payment Type"===n)a="LCP"===a?"LCP":"GP"===a?"GP":a;else if("Payment Frequency"===n);else if("Amount"===n){let e=parseFloat(a.replace(/[,$]/g,""));a=isNaN(e)?a:`$${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}t.push(a)}),n.push(t)});let r=N.utils.book_new(),s=N.utils.aoa_to_sheet(n);s["!cols"]=[{wch:8},{wch:6},{wch:15},{wch:15},{wch:20},{wch:12},{wch:15},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:12},{wch:15},{wch:12},{wch:15},{wch:15},{wch:15},{wch:25},{wch:20},{wch:15},{wch:15},{wch:8},{wch:10}],N.utils.book_append_sheet(r,s,"Pricing Data");let l=new Date().toISOString().slice(0,10),m=`${a}-${l}.xlsx`;N.writeFile(r,m),console.log(`✅ Exported ${t.length} rows to ${m}`)}catch(e){console.error("Export error:",e),alert(`Export failed: ${e}`)}}function P(e){let t=e.length,n=e.filter(e=>e.firstName&&e.lastName&&e.paymentAmount).length;return{totalRows:t,validRows:n,emptyRows:t-n}}},1342:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m,metadata:()=>l});var a=n(5036),r=n(3640),s=n.n(r);n(5023);let l={title:"Pricing Sheet",description:"Insurance pricing calculator"};function m({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:s().className,children:e})})}},5023:()=>{}};